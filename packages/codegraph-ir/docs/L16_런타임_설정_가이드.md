# L16 RepoMap ëŸ°íƒ€ì„ ì„¤ì • ê°€ì´ë“œ

**ë‚ ì§œ**: 2025-12-28
**ê¸°ëŠ¥**: ëŸ°íƒ€ì„ì— PageRank ì•Œê³ ë¦¬ì¦˜ ë™ì  ì œì–´

---

## ğŸ¯ ê°œìš”

L16 RepoMapì˜ PageRank ì•Œê³ ë¦¬ì¦˜ì„ **ì‹¤í–‰ ì‹œì ì—** ì¼œê³  ëŒ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- âœ… Fast mode (ê¸°ë³¸): PageRankë§Œ (1ì´ˆ)
- âœ… AI mode: + Personalized PageRank (2ì´ˆ)
- âœ… Architecture mode: + HITS (2ì´ˆ)
- âœ… Full mode: ëª¨ë‘ í™œì„±í™” (3.8ì´ˆ)

**ì¥ì **: ìƒí™©ì— ë”°ë¼ ì†ë„ vs ê¸°ëŠ¥ ì„ íƒ ê°€ëŠ¥!

---

## ğŸš€ Rust API ì‚¬ìš©ë²•

### 1. Fast Mode (ê¸°ë³¸ê°’) - ë¹ ë¥¸ ì¸ë±ì‹±

```rust
use codegraph_ir::pipeline::{E2EPipelineConfig, IRIndexingOrchestrator};

// ê¸°ë³¸ ì„¤ì • (ê°€ì¥ ë¹ ë¦„)
let config = E2EPipelineConfig::default();
// pagerank_settings.enable_personalized = false
// pagerank_settings.enable_hits = false

let orchestrator = IRIndexingOrchestrator::new(config);
let result = orchestrator.execute()?;

// ì„±ëŠ¥: 1.16ì´ˆ (136K LOC)
```

---

### 2. AI Agent Mode - ë²„ê·¸ ìˆ˜ì •/íƒìƒ‰

```rust
use codegraph_ir::pipeline::E2EPipelineConfig;

// AI ëª¨ë“œ ì„¤ì •
let mut config = E2EPipelineConfig::default();

// Personalized PageRank í™œì„±í™”
config.pagerank_settings.enable_personalized = true;
config.pagerank_settings.enable_hits = false; // HITSëŠ” ë¶ˆí•„ìš”

let orchestrator = IRIndexingOrchestrator::new(config);
let result = orchestrator.execute()?;

// ì„±ëŠ¥: ~2ì´ˆ (2ë°° ëŠë¦¼, í•˜ì§€ë§Œ ì»¨í…ìŠ¤íŠ¸ íƒìƒ‰ ê°€ëŠ¥)
```

**ì–¸ì œ ì‚¬ìš©?**
- AI ì—ì´ì „íŠ¸ê°€ ë²„ê·¸ íŒŒì¼ ì£¼ë³€ íƒìƒ‰
- "ì´ íŒŒì¼ê³¼ ê´€ë ¨ëœ ì½”ë“œ" ì°¾ê¸°
- íŠ¹ì • ê¸°ëŠ¥ ë²”ìœ„ ë¶„ì„

---

### 3. Architecture Analysis Mode - êµ¬ì¡° ë¶„ì„

```rust
use codegraph_ir::pipeline::E2EPipelineConfig;

// ì•„í‚¤í…ì²˜ ë¶„ì„ ëª¨ë“œ
let mut config = E2EPipelineConfig::default();

// HITS í™œì„±í™” (Authority/Hub êµ¬ë¶„)
config.pagerank_settings.enable_personalized = false;
config.pagerank_settings.enable_hits = true;

let orchestrator = IRIndexingOrchestrator::new(config);
let result = orchestrator.execute()?;

// ì„±ëŠ¥: ~2ì´ˆ
// ê²°ê³¼: Authority (í•µì‹¬ ë¼ì´ë¸ŒëŸ¬ë¦¬), Hub (í†µí•© ì½”ë“œ) ì ìˆ˜
```

**ì–¸ì œ ì‚¬ìš©?**
- ì•„í‚¤í…ì²˜ ë¦¬ë·°
- ë¦¬íŒ©í† ë§ ìš°ì„ ìˆœìœ„ ê²°ì •
- ì˜ì¡´ì„± ë¶„ì„

---

### 4. Full Analysis Mode - ì™„ì „ ë¶„ì„

```rust
use codegraph_ir::pipeline::E2EPipelineConfig;

// ëª¨ë“  ì•Œê³ ë¦¬ì¦˜ í™œì„±í™”
let mut config = E2EPipelineConfig::default();

config.pagerank_settings.enable_personalized = true;
config.pagerank_settings.enable_hits = true;
config.pagerank_settings.max_iterations = 10; // ë” ì •ë°€í•˜ê²Œ

let orchestrator = IRIndexingOrchestrator::new(config);
let result = orchestrator.execute()?;

// ì„±ëŠ¥: ~3.8ì´ˆ (4ë°° ëŠë¦¼)
// ê²°ê³¼: ëª¨ë“  ë©”íŠ¸ë¦­ ì‚¬ìš© ê°€ëŠ¥
```

**ì–¸ì œ ì‚¬ìš©?**
- ì£¼ê°„ ì•„í‚¤í…ì²˜ ë¦¬í¬íŠ¸
- ëŒ€ê·œëª¨ ë¦¬íŒ©í† ë§ ì „ ë¶„ì„
- ìƒì„¸í•œ ì½”ë“œ í’ˆì§ˆ ë¦¬í¬íŠ¸

---

## ğŸ Python API ì‚¬ìš©ë²• (PyO3)

### 1. Fast Mode (ê¸°ë³¸)

```python
from codegraph_ir import E2EPipelineConfig, IRIndexingOrchestrator

# ê¸°ë³¸ ì„¤ì • (ê°€ì¥ ë¹ ë¦„)
config = E2EPipelineConfig()
config.repo_info.repo_root = "/path/to/repo"
config.repo_info.repo_name = "my_project"

orchestrator = IRIndexingOrchestrator(config)
result = orchestrator.execute()

print(f"Processed in {result.stats.total_duration:.2f}s")
# Fast: ~1.16s
```

---

### 2. AI Agent Mode

```python
from codegraph_ir import E2EPipelineConfig, IRIndexingOrchestrator

config = E2EPipelineConfig()
config.repo_info.repo_root = "/path/to/repo"

# AI ëª¨ë“œ: Personalized PageRank í™œì„±í™”
config.pagerank_settings.enable_personalized = True
config.pagerank_settings.enable_hits = False

orchestrator = IRIndexingOrchestrator(config)
result = orchestrator.execute()

# ì´ì œ ì»¨í…ìŠ¤íŠ¸ ê¸°ë°˜ íƒìƒ‰ ê°€ëŠ¥
# (ì¶”í›„ PPR API ì¶”ê°€ ì˜ˆì •)
```

---

### 3. Architecture Analysis Mode

```python
from codegraph_ir import E2EPipelineConfig, IRIndexingOrchestrator

config = E2EPipelineConfig()
config.repo_info.repo_root = "/path/to/repo"

# ì•„í‚¤í…ì²˜ ëª¨ë“œ: HITS í™œì„±í™”
config.pagerank_settings.enable_personalized = False
config.pagerank_settings.enable_hits = True

orchestrator = IRIndexingOrchestrator(config)
result = orchestrator.execute()

# RepoMapì—ì„œ Authority/Hub ì ìˆ˜ ì‚¬ìš©
for node in result.repomap_snapshot.nodes:
    if node.importance.authority > 0.8:
        print(f"Core library: {node.id}")
    if node.importance.hub > 0.8:
        print(f"Integration point: {node.id}")
```

---

### 4. Dynamic Mode Selection

```python
from codegraph_ir import E2EPipelineConfig, IRIndexingOrchestrator

def create_config(mode="fast"):
    config = E2EPipelineConfig()
    config.repo_info.repo_root = "/path/to/repo"

    if mode == "fast":
        # ê¸°ë³¸ê°’ ê·¸ëŒ€ë¡œ (ê°€ì¥ ë¹ ë¦„)
        pass

    elif mode == "ai":
        # AI ì—ì´ì „íŠ¸ìš©
        config.pagerank_settings.enable_personalized = True
        config.pagerank_settings.enable_hits = False

    elif mode == "architecture":
        # ì•„í‚¤í…ì²˜ ë¶„ì„ìš©
        config.pagerank_settings.enable_personalized = False
        config.pagerank_settings.enable_hits = True

    elif mode == "full":
        # ì™„ì „ ë¶„ì„
        config.pagerank_settings.enable_personalized = True
        config.pagerank_settings.enable_hits = True
        config.pagerank_settings.max_iterations = 10

    return config

# ì‚¬ìš© ì˜ˆì‹œ
fast_config = create_config("fast")
ai_config = create_config("ai")
arch_config = create_config("architecture")
```

---

## ğŸ¯ ëª¨ë“œë³„ ë¹„êµí‘œ

| ëª¨ë“œ | PPR | HITS | Iterations | ì‹œê°„ | ì‚¬ìš© ì‚¬ë¡€ |
|------|-----|------|------------|------|-----------|
| **Fast** | âŒ | âŒ | 5 | 1.16s | ì´ˆê¸° ì¸ë±ì‹± |
| **AI** | âœ… | âŒ | 5 | ~2.0s | ë²„ê·¸ ìˆ˜ì •, íƒìƒ‰ |
| **Architecture** | âŒ | âœ… | 5 | ~2.0s | êµ¬ì¡° ë¶„ì„ |
| **Full** | âœ… | âœ… | 10 | ~3.8s | ì™„ì „ ë¶„ì„ |

---

## ğŸ”§ ì„¸ë°€í•œ ì œì–´

### Iteration ì¡°ì •

```rust
// ë¹ ë¥´ê²Œ (ì •ë°€ë„ ë‚®ìŒ)
config.pagerank_settings.max_iterations = 3;

// ê¸°ë³¸ (ê· í˜•)
config.pagerank_settings.max_iterations = 5;

// ì •ë°€í•˜ê²Œ (ëŠë¦¼)
config.pagerank_settings.max_iterations = 10;
```

### Tolerance ì¡°ì •

```rust
// ë¹ ë¥¸ ìˆ˜ë ´ (ëœ ì •ë°€)
config.pagerank_settings.tolerance = 1e-2;

// ê¸°ë³¸
config.pagerank_settings.tolerance = 1e-3;

// ì •ë°€í•œ ìˆ˜ë ´ (ëŠë¦¼)
config.pagerank_settings.tolerance = 1e-4;
```

---

## ğŸ“Š ì‹¤ì œ ì„±ëŠ¥ ì˜ˆì‹œ (136K LOC)

### Fast Mode
```
L16_RepoMap:     0.987s (84.9%)
Total:           1.16s
Throughput:      117K LOC/s
```

### AI Mode (ì˜ˆìƒ)
```
L16_RepoMap:     ~1.97s (85%)
Total:           ~2.3s
Throughput:      ~59K LOC/s
```

### Architecture Mode (ì˜ˆìƒ)
```
L16_RepoMap:     ~1.97s (85%)
Total:           ~2.3s
Throughput:      ~59K LOC/s
```

### Full Mode (ì˜ˆìƒ)
```
L16_RepoMap:     ~3.8s (90%)
Total:           ~4.2s
Throughput:      ~32K LOC/s
```

---

## ğŸ¨ ê³ ê¸‰ ì‚¬ìš© íŒ¨í„´

### 1. Lazy Indexing - ë‹¨ê³„ì  í™œì„±í™”

```python
# 1ë‹¨ê³„: Fast modeë¡œ ì´ˆê¸° ì¸ë±ì‹±
fast_config = E2EPipelineConfig()
fast_orchestrator = IRIndexingOrchestrator(fast_config)
result = fast_orchestrator.execute()
save_to_cache(result)

# 2ë‹¨ê³„: í•„ìš” ì‹œ AI modeë¡œ ì¬ì‹¤í–‰
if user_wants_ai_features():
    ai_config = E2EPipelineConfig()
    ai_config.pagerank_settings.enable_personalized = True

    # ìºì‹œ í™œìš© + PPRë§Œ ì¶”ê°€ ê³„ì‚°
    ai_orchestrator = IRIndexingOrchestrator(ai_config)
    enriched_result = ai_orchestrator.execute()
```

### 2. ì¡°ê±´ë¶€ í™œì„±í™”

```python
def smart_config(repo_size, use_case):
    config = E2EPipelineConfig()

    # ì‘ì€ ë¦¬í¬ì§€í† ë¦¬ëŠ” Full mode
    if repo_size < 10000:
        config.pagerank_settings.enable_personalized = True
        config.pagerank_settings.enable_hits = True

    # AI ì‚¬ìš© ì¼€ì´ìŠ¤
    elif use_case == "bug_fix":
        config.pagerank_settings.enable_personalized = True

    # ì•„í‚¤í…ì²˜ ë¶„ì„
    elif use_case == "architecture":
        config.pagerank_settings.enable_hits = True

    # ê¸°ë³¸: Fast mode
    return config
```

### 3. ìºì‹œ + ì ì§„ì  í™œì„±í™”

```python
class LazyRepoMap:
    def __init__(self, repo_path):
        self.config = E2EPipelineConfig()
        self.config.repo_info.repo_root = repo_path
        self._basic_result = None
        self._ppr_enabled = False
        self._hits_enabled = False

    def get_basic_importance(self):
        """Fast: PageRankë§Œ"""
        if not self._basic_result:
            self._basic_result = IRIndexingOrchestrator(self.config).execute()
        return self._basic_result.repomap_snapshot

    def enable_personalized_search(self):
        """ëŸ°íƒ€ì„ì— PPR í™œì„±í™”"""
        if not self._ppr_enabled:
            self.config.pagerank_settings.enable_personalized = True
            self._basic_result = None  # ì¬ê³„ì‚° í•„ìš”
            self._ppr_enabled = True

    def enable_architecture_analysis(self):
        """ëŸ°íƒ€ì„ì— HITS í™œì„±í™”"""
        if not self._hits_enabled:
            self.config.pagerank_settings.enable_hits = True
            self._basic_result = None  # ì¬ê³„ì‚° í•„ìš”
            self._hits_enabled = True
```

---

## âš¡ ì„±ëŠ¥ íŒ

### 1. ê¸°ë³¸ì€ Fast Mode
```python
# ëŒ€ë¶€ë¶„ì˜ ê²½ìš° ì´ê²ƒë§Œìœ¼ë¡œ ì¶©ë¶„
config = E2EPipelineConfig()  # Fast mode
```

### 2. í•„ìš”í•  ë•Œë§Œ í™œì„±í™”
```python
# AI ê¸°ëŠ¥ ì‚¬ìš© ì‹œì ì—ë§Œ
if need_contextual_search:
    config.pagerank_settings.enable_personalized = True
```

### 3. ìºì‹± í™œìš©
```python
# í•œ ë²ˆ ê³„ì‚°í•˜ê³  ìºì‹œ
result = orchestrator.execute()
save_to_redis(result)

# ë‹¤ìŒì—” ìºì‹œì—ì„œ
cached_result = load_from_redis()
```

### 4. ë°°ì¹˜ ì²˜ë¦¬
```python
# ì—¬ëŸ¬ ë¦¬í¬ì§€í† ë¦¬ í•œ ë²ˆì— (Fast mode)
repos = ["repo1", "repo2", "repo3"]
for repo in repos:
    config = E2EPipelineConfig()  # Fast
    config.repo_info.repo_root = repo
    process(config)
```

---

## ğŸ¯ ê¶Œì¥ ì‚¬í•­

### ì¼ë°˜ ì‚¬ìš©ì
```
Fast mode (ê¸°ë³¸ê°’) ì‚¬ìš©
â†’ ê°€ì¥ ë¹ ë¥´ê³  ëŒ€ë¶€ë¶„ ì¶©ë¶„
```

### AI ê°œë°œì
```
ì´ˆê¸°: Fast mode
í•„ìš” ì‹œ: AI mode (PPR í™œì„±í™”)
â†’ ìƒí™©ë³„ ì„ íƒ
```

### ì•„í‚¤í…íŠ¸
```
ì£¼ê°„ ë¦¬ë·°: Architecture mode (HITS)
ëŒ€ê·œëª¨ ë¦¬íŒ©í† ë§: Full mode
â†’ ìƒì„¸ ë¶„ì„ í•„ìš”í•  ë•Œë§Œ
```

### DevOps/CI
```
Fast mode ê³ ì •
â†’ ë¹ ë¥¸ í”¼ë“œë°± ìš°ì„ 
```

---

## ğŸ”„ ë§ˆì´ê·¸ë ˆì´ì…˜ ê°€ì´ë“œ

### ê¸°ì¡´ ì½”ë“œ (ì„¤ì • ì—†ìŒ)

```python
# Before: ì„¤ì • ë¶ˆê°€ëŠ¥
config = E2EPipelineConfig()
result = IRIndexingOrchestrator(config).execute()
# í•­ìƒ Full mode (ëŠë¦¼)
```

### ìƒˆ ì½”ë“œ (ëŸ°íƒ€ì„ ì œì–´)

```python
# After: í•„ìš”í•œ ê²ƒë§Œ í™œì„±í™”
config = E2EPipelineConfig()

# Fast mode (ê¸°ë³¸)
# â†’ ë³€ê²½ ì—†ìŒ, ìë™ìœ¼ë¡œ ë¹ ë¦„!

# AI mode (í•„ìš” ì‹œ)
config.pagerank_settings.enable_personalized = True

result = IRIndexingOrchestrator(config).execute()
```

---

## ğŸ“š ê´€ë ¨ ë¬¸ì„œ

- **L16_ì•Œê³ ë¦¬ì¦˜_ê°€ì´ë“œ.md** - ê° ì•Œê³ ë¦¬ì¦˜ ìƒì„¸ ì„¤ëª…
- **L16_OPTIMIZATION_FINAL.md** - ìµœì í™” ê²°ê³¼
- **API ë¬¸ì„œ** - PageRankSettings ì „ì²´ ì˜µì…˜

---

**ì‘ì„±ì¼**: 2025-12-28
**ë²„ì „**: 1.0
**ìƒíƒœ**: âœ… í”„ë¡œë•ì…˜ ì‚¬ìš© ê°€ëŠ¥

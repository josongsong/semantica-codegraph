# Semantica Agent Architecture - SOTA Overview

**Date**: 2024-11-25
**Goal**: Cursor/Claude Codeë¥¼ ë„˜ì–´ì„œëŠ” SOTAê¸‰ ì½”ë”© ì—ì´ì „íŠ¸

---

## ğŸ¯ í•µì‹¬ ì„¤ê³„ ì›ì¹™

1. **Human-in-the-Loop First**: ì‹ ë¢°ì™€ ì œì–´ê¶Œì´ ìµœìš°ì„ 
2. **Graph-Powered Intelligence**: Semanticaì˜ ì½”ë“œ ê·¸ë˜í”„ë¥¼ ëª¨ë“  ì¶”ë¡ ì— í™œìš©
3. **Multi-Mode Specialization**: ì‘ì—… ìœ í˜•ë³„ ì „ë¬¸í™”ëœ ì—ì´ì „íŠ¸ ëª¨ë“œ
4. **Self-Improving**: ê²½í—˜ì—ì„œ ë°°ìš°ê³  ê°œì„ 
5. **Transparent & Explainable**: ëª¨ë“  ê²°ì •ì„ ì„¤ëª… ê°€ëŠ¥

---

## ğŸ“ ì „ì²´ ì•„í‚¤í…ì²˜

```mermaid
graph TB
    User[User Request] --> ModeSelector[Mode Selector]

    ModeSelector --> DesignMode[Design Mode]
    ModeSelector --> ImplementMode[Implementation Mode]
    ModeSelector --> DebugMode[Debug/Troubleshooting Mode]
    ModeSelector --> QAMode[QA/Review Mode]
    ModeSelector --> TestMode[Test Mode]
    ModeSelector --> RefactorMode[Refactor Mode]

    subgraph "Core Intelligence Layer"
        IntentAnalyzer[Intent Analyzer]
        QueryPlanner[Query Planner]
        GraphAnalyzer[Graph Analyzer]
        ReflectionEngine[Self-Reflection Engine]
        Memory[Memory & Learning]
    end

    DesignMode --> IntentAnalyzer
    ImplementMode --> IntentAnalyzer
    DebugMode --> IntentAnalyzer
    QAMode --> IntentAnalyzer
    TestMode --> IntentAnalyzer
    RefactorMode --> IntentAnalyzer

    IntentAnalyzer --> QueryPlanner
    QueryPlanner --> GraphAnalyzer
    QueryPlanner --> ToolLayer[Tool Layer]

    ToolLayer --> Execution[Execution]
    Execution --> ReflectionEngine
    ReflectionEngine --> HumanApproval{Human Approval?}

    HumanApproval -->|Approved| Commit[Commit Changes]
    HumanApproval -->|Modify| QueryPlanner
    HumanApproval -->|Reject| Rollback[Rollback]

    Commit --> Memory
    Rollback --> Memory

    Memory --> SkillLibrary[Skill Library]
    SkillLibrary --> QueryPlanner

    style User fill:#e1f5ff
    style HumanApproval fill:#fff4e1
    style Memory fill:#f0e6ff
    style GraphAnalyzer fill:#e6ffe6
```

---

## ğŸš€ êµ¬í˜„ ë¡œë“œë§µ (Phaseë³„)

```mermaid
gantt
    title Semantica Agent Implementation Roadmap
    dateFormat YYYY-MM-DD

    section Phase 0: Foundation
    Human-in-the-Loop System     :p0_1, 2024-11-26, 3d
    Approval & Visualization      :p0_2, after p0_1, 2d
    Agent Narrator                :p0_3, after p0_2, 2d

    section Phase 1: Core Intelligence
    Intent Understanding          :p1_1, after p0_3, 4d
    Query Planning                :p1_2, after p1_1, 3d
    Self-Reflection Engine        :p1_3, after p1_2, 5d
    Basic Memory System           :p1_4, after p1_3, 3d

    section Phase 2: Agent Modes
    Mode Selector                 :p2_1, after p1_4, 2d
    Implementation Mode           :p2_2, after p2_1, 3d
    Debug Mode                    :p2_3, after p2_2, 3d
    Design Mode                   :p2_4, after p2_3, 4d
    QA Mode                       :p2_5, after p2_4, 3d
    Test Mode                     :p2_6, after p2_5, 2d

    section Phase 3: Advanced Features
    Tree-of-Thoughts Planning     :p3_1, after p2_6, 5d
    Skill Library                 :p3_2, after p3_1, 4d
    Pattern Learning              :p3_3, after p3_2, 4d
    Multi-Agent Collaboration     :p3_4, after p3_3, 5d
```

---

## ğŸ­ Agent Modes (ì‘ì—…ë³„ ì „ë¬¸í™”)

### Mode ì„ íƒ ê¸°ì¤€

```mermaid
flowchart TD
    Start[User Request] --> Classify{Request Type?}

    Classify -->|"Design new system"| DesignMode[ğŸ¨ Design Mode]
    Classify -->|"Implement feature"| ImplementMode[ğŸ’» Implementation Mode]
    Classify -->|"Fix bug/error"| DebugMode[ğŸ› Debug Mode]
    Classify -->|"Review code"| QAMode[âœ… QA Mode]
    Classify -->|"Write tests"| TestMode[ğŸ§ª Test Mode]
    Classify -->|"Improve code"| RefactorMode[â™»ï¸ Refactor Mode]

    DesignMode --> DesignFlow[Architecture Planning]
    ImplementMode --> ImplFlow[Code Generation]
    DebugMode --> DebugFlow[Error Analysis]
    QAMode --> QAFlow[Quality Check]
    TestMode --> TestFlow[Test Generation]
    RefactorMode --> RefactorFlow[Code Improvement]

    style DesignMode fill:#e1f5ff
    style ImplementMode fill:#e6ffe6
    style DebugMode fill:#ffe6e6
    style QAMode fill:#fff4e1
    style TestMode fill:#f0e6ff
    style RefactorMode fill:#ffe6f5
```

ê° ëª¨ë“œë³„ ìƒì„¸ ë‚´ìš©ì€ [01.Agent_Modes.md](01.Agent_Modes.md) ì°¸ì¡°

---

## ğŸ”„ Execution Flow (ëª¨ë“  ëª¨ë“œ ê³µí†µ)

```mermaid
sequenceDiagram
    participant User
    participant Agent
    participant Intent
    participant Planner
    participant Graph
    participant Tools
    participant Reflection
    participant Memory

    User->>Agent: Request
    Agent->>Intent: Analyze Intent
    Intent-->>Agent: Intent + Constraints

    Agent->>Planner: Create Plan
    Planner->>Graph: Analyze Dependencies
    Graph-->>Planner: Impact Analysis
    Planner-->>Agent: Execution Plan

    Agent->>User: ğŸ“‹ Show Plan (Approval 1)
    User-->>Agent: Approved

    Agent->>Tools: Execute Tools
    Tools-->>Agent: Results

    Agent->>Reflection: Verify Results
    Reflection->>Tools: Run Tests
    Tools-->>Reflection: Test Results

    alt Tests Passed
        Reflection-->>Agent: âœ… Verification Passed
        Agent->>User: ğŸ“Š Show Results (Approval 2)
        User-->>Agent: Approved
        Agent->>Memory: Record Success
    else Tests Failed
        Reflection-->>Agent: âŒ Verification Failed
        Agent->>Reflection: Analyze Failure
        Reflection-->>Agent: Correction Plan
        Agent->>User: ğŸ”„ Show Correction (Approval 3)
        User-->>Agent: Retry/Abort
    end
```

---

## ğŸ§  Core Intelligence Components

### 1. Intent Understanding
- **ì…ë ¥**: Natural language request
- **ì¶œë ¥**: Structured Intent + Constraints + Success Criteria
- **ê¸°ë²•**: Multi-level classification + Entity extraction

### 2. Query Planning
- **ì…ë ¥**: Intent + Available Tools
- **ì¶œë ¥**: Execution Plan (DAG of tool calls)
- **ê¸°ë²•**: Graph-aware planning + Cost optimization

### 3. Graph Analysis (Semantica ì°¨ë³„í™”)
- **ì…ë ¥**: Proposed changes
- **ì¶œë ¥**: Impact Analysis + Dependency Graph
- **ê¸°ë²•**: Call graph + Dependency graph + Symbol resolution

### 4. Self-Reflection
- **ì…ë ¥**: Execution results + Original intent
- **ì¶œë ¥**: Verification Result + Correction Plan
- **ê¸°ë²•**: Multi-level verification + Error analysis

### 5. Memory & Learning
- **ì…ë ¥**: Successful/Failed episodes
- **ì¶œë ¥**: Learned skills + Patterns
- **ê¸°ë²•**: Episodic memory + Skill extraction

---

## ğŸ¯ Semanticaë§Œì˜ ì°¨ë³„í™” í¬ì¸íŠ¸

### 1. **Graph-Powered Everything**

```mermaid
graph LR
    subgraph "ì¼ë°˜ ì—ì´ì „íŠ¸"
        A1[Request] --> A2[Generate Code]
        A2 --> A3[Test]
        A3 --> A4[Hope it works ğŸ¤]
    end

    subgraph "Semantica Agent"
        B1[Request] --> B2[Analyze Graph]
        B2 --> B3[Predict Impact]
        B3 --> B4[Generate Code]
        B4 --> B5[Verify with Graph]
        B5 --> B6[Confident Result âœ…]
    end

    style A4 fill:#ffe6e6
    style B6 fill:#e6ffe6
```

**ì˜ˆì‹œ**:
- ì¼ë°˜: "User.py ìˆ˜ì •í–ˆì–´ìš”"
- **Semantica**: "User.py ìˆ˜ì • â†’ UserService(5ê°œ í•¨ìˆ˜), UserHandler(3ê°œ ì—”ë“œí¬ì¸íŠ¸)ì— ì˜í–¥. í…ŒìŠ¤íŠ¸ 12ê°œ ì‹¤í–‰ í•„ìš” [ê·¸ë˜í”„ ì‹œê°í™”]"

### 2. **Symbol-Level Precision**
- íŒŒì¼ ë ˆë²¨ì´ ì•„ë‹Œ **ì‹¬ë³¼ ë ˆë²¨** ë¶„ì„/ìˆ˜ì •
- "ì´ í´ë˜ìŠ¤ì˜ ëª¨ë“  ë©”ì„œë“œì— logging ì¶”ê°€" ê°™ì€ ì •ë°€ ì‘ì—…

### 3. **Historical Pattern Learning**
- ê³¼ê±° ì„±ê³µ/ì‹¤íŒ¨ íŒ¨í„´ í•™ìŠµ
- "ì§€ë‚œë²ˆ ë¹„ìŠ·í•œ ë¦¬íŒ©í† ë§ì—ì„œ ì´ ë°©ë²•ì´ íš¨ê³¼ì ì´ì—ˆìŒ"

### 4. **Dependency-Aware Execution**
- ì´ë¯¸ êµ¬í˜„ëœ `DependencyAwareOrdering` í™œìš©
- "íŒŒì¼ A â†’ B â†’ C ìˆœì„œë¡œ ìˆ˜ì •í•´ì•¼ ì•ˆì „í•¨"

---

## ğŸ“Š Success Metrics

### ì‚¬ìš©ì ê²½í—˜ ì§€í‘œ
- **Task Success Rate**: 95%+ (ì²« ì‹œë„ ì„±ê³µë¥ )
- **Approval Rate**: ì‚¬ìš©ìê°€ ì œì•ˆ ìŠ¹ì¸í•˜ëŠ” ë¹„ìœ¨ >90%
- **Rollback Rate**: <5% (ì˜ëª»ëœ ìˆ˜ì •ìœ¼ë¡œ ì¸í•œ ë¡¤ë°±)

### ì„±ëŠ¥ ì§€í‘œ
- **Response Time**: Plan ìƒì„± <5ì´ˆ, ì‹¤í–‰ <30ì´ˆ
- **Confidence Accuracy**: Confidence 90% ì˜ˆì¸¡ â†’ ì‹¤ì œ ì„±ê³µë¥  >85%
- **Test Coverage**: ìˆ˜ì •í•œ ì½”ë“œì˜ í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€ >80%

### í•™ìŠµ ì§€í‘œ
- **Skill Library Growth**: ì£¼ë‹¹ 3-5ê°œ ìƒˆë¡œìš´ íŒ¨í„´ í•™ìŠµ
- **Pattern Reuse**: í•™ìŠµí•œ ìŠ¤í‚¬ ì¬ì‚¬ìš©ë¥  >50%
- **Error Reduction**: ìœ ì‚¬ ì‘ì—… ë°˜ë³µ ì‹œ ì—ëŸ¬ìœ¨ ê°ì†Œ ì¶”ì„¸

---

## ğŸš§ Implementation Status

### âœ… ì™„ë£Œ
- Retriever SOTA Enhancements (Late Interaction Cache, LLM Reranker Cache, etc.)
- Dependency-aware Ordering
- Contextual Query Expansion
- Basic Tool Layer

### ğŸš§ ì§„í–‰ ì¤‘
- Human-in-the-Loop System (Phase 0)
- Intent Understanding (Phase 1)

### ğŸ“‹ ì˜ˆì •
- Agent Modes (Phase 2)
- Advanced Planning (Phase 3)
- Memory & Learning (Phase 3)

---

## ğŸ“š ê´€ë ¨ ë¬¸ì„œ

1. [01.Agent_Modes.md](01.Agent_Modes.md) - ëª¨ë“œë³„ ìƒì„¸ ì„¤ê³„
2. [02.Human_in_the_Loop.md](02.Human_in_the_Loop.md) - ìŠ¹ì¸ ì‹œìŠ¤í…œ
3. [03.Self_Reflection.md](03.Self_Reflection.md) - ìê¸° ê²€ì¦
4. [04.Memory_Learning.md](04.Memory_Learning.md) - í•™ìŠµ ë©”ì»¤ë‹ˆì¦˜
5. [05.Graph_Intelligence.md](05.Graph_Intelligence.md) - ê·¸ë˜í”„ í™œìš©

---

**ì‘ì„±ì**: Claude Code + Human Collaboration
**ìµœì¢… ìˆ˜ì •**: 2024-11-25
